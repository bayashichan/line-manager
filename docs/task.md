# LINE公式アカウント管理ツール開発タスク

## Phase 0: 設計ドキュメント作成 ✅
- [x] データベースER図の作成（リッチメニュー切り替えロジック含む）
- [x] タグ付与時の処理フロー（シーケンス図）の作成
- [x] 実装計画書の作成

## Phase 1: 基盤構築 ✅
- [x] Next.jsプロジェクトのセットアップ
- [x] Supabaseスキーマの作成
- [x] Supabaseクライアント設定
- [x] 認証機能（ログイン/サインアップ）
- [x] ダッシュボードレイアウト
- [x] LINE Webhook接続の実装
- [x] 友だちDB保存機能の実装
- [x] タグ付与/解除時のリッチメニュー自動切り替えロジック

## Phase 2: 管理画面構築 ✅
- [x] 友だち管理画面（一覧、検索、タグ付け、CSVエクスポート）
- [x] タグ管理画面（CRUD、リッチメニュー連動設定、優先度設定）
- [x] リッチメニュー管理画面（作成、編集、画像アップロード、デフォルト設定）
- [x] メッセージ配信画面（テキスト配信、セグメント配信、配信履歴）
- [x] ステップ配信画面（シナリオCRUD、トリガー設定）
- [x] 設定画面（チャンネル設定、Webhook URL表示）

## Phase 3: 拡張機能 ✅
- [x] LINE APIへのリッチメニュー登録機能
- [x] リッチメニューのタップ領域エディタ
- [x] 画像・動画メッセージ配信
- [x] 予約配信機能（スケジュール設定UI）

## Phase 4: 運用機能 ✅
- [x] 配信統計ダッシュボード
- [x] チーム管理ページ
- [x] 操作ログページ
- [x] 予約配信/ステップ配信のCron処理

## Phase 5: データ移行機能 ✅
- [x] 友だち・タグCSVインポート機能

## Phase 6: 自動化機能 ✅
- [x] 友だち追加時の自動アクション

## Phase 7: メッセージ配信強化（現在のタスク）
- [x] UI機能強化
  - [x] 配信メッセージ作成画面での文字数カウント・警告表示
  - [x] 吹き出し数（メッセージブロック）の上限（5つ）制限バリデーション
- [x] リッチメッセージ実装
  - [x] 画像メッセージ設定に「リンク先URL」入力欄を追加
  - [x] バックエンド送信処理で、リンク付き画像を `Flex Message` に変換して送信するロジック実装

## Phase 8: セキュリティ強化とマルチテナント化（現在のタスク）
- [x] データベース改修
  - [x] `channels` テーブルにパスワードカラム追加
- [x] チャンネル管理機能
  - [x] リポジトリ/アカウントの新規追加画面
  - [x] チャンネル設定画面でのパスワード設定UI
- [x] マルチチャンネル対応
  - [x] チャンネルごとのデータ分離（CookieによるID管理）
  - [x] チャンネル切り替え時のパスワード認証モーダル
- [x] メンバー管理機能（追加）
  - [x] メールアドレスによるメンバー招待API
  - [x] チーム管理画面のUI改修

## Phase 9: UI/UX改善とレスポンシブ対応（現在のタスク）
- [x] 全体のレイアウト調整
  - [x] モバイル用ナビゲーションの動作確認・調整
  - [x] コンテンツエリアのパディング調整
- [x] 各ページのレスポンシブ化
  - [x] ダッシュボードトップ（カード配置など）
  - [x] 友だちリスト（テーブルの横スクロール/カード化対応）
  - [x] メッセージ作成画面（プレビュー表示、フォーム要素の最適化）
  - [x] リッチメニュー作成画面（キャンバス操作の調整）
  - [x] その他設定画面（フォーム幅の調整）
5. 
## Phase 10: 友だち管理機能強化（現在のタスク）
- [x] 友だち管理用ネーム（internal_name）設定機能
  - [x] UIでの編集導線の明確化（編集ボタン追加など）
  - [x] DBカラムの確認と保存処理の検証

